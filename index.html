<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NON-ESCALATOR ENM RELATIONSHIP MENU</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0 auto;
            padding: 15px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 50%, #dee2e6 100%);
            min-height: 100vh;
            line-height: 1.4;
            max-width: 100%;
            text-align: center;
        }
        
        h1 {
            color: #495057;
            text-align: center;
            margin: 0 0 20px 0;
            font-size: 1.6em;
            padding: 0 10px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(255,255,255,0.8);
            letter-spacing: -0.5px;
        }
        
        .language-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            border: 2px solid #6c757d;
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 0.9em;
            font-weight: 600;
            color: #495057;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .language-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            border-color: #495057;
        }
        
        .partner-names {
            text-align: center;
            margin-bottom: 30px;
            font-size: 1em;
            color: #495057;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            font-weight: 500;
        }
        
        .partner-names span {
            font-size: 1.2em;
            font-weight: 600;
        }
        
        .partner-names input[type="text"] {
            width: 100%;
            max-width: 200px;
            padding: 14px 18px;
            border: 2px solid #dee2e6;
            border-radius: 25px;
            font-size: 16px;
            text-align: center;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            font-weight: 500;
            color: #495057;
        }
        
        .partner-names input[type="text"]:focus {
            outline: none;
            background: rgba(255,255,255,1);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            border-color: #6c757d;
        }
        
        .legend {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(15px);
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 2px solid rgba(108,117,125,0.2);
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            font-size: 1em;
            text-align: center;
        }
        
        .legend span {
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.1em;
            color: #495057;
        }
        
        .section {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(15px);
            padding: 25px 20px;
            margin-bottom: 20px;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 2px solid rgba(108,117,125,0.2);
        }
        
        h2 {
            color: #495057;
            margin: 0 0 25px 0;
            border-bottom: 2px solid rgba(108,117,125,0.2);
            padding-bottom: 15px;
            font-size: 1.3em;
            text-align: left; /* 从center改为left */
            font-weight: 700;
            letter-spacing: -0.3px;
        }
        
        .item {
            margin: 18px 0;
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding: 20px 18px;
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 12px;
            border: 2px solid rgba(108,117,125,0.15);
            transition: all 0.3s ease;
        }
        
        .item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
            border-color: rgba(108,117,125,0.3);
        }
        
        .item-text {
            font-size: 1.1em;
            color: #495057;
            font-weight: 500;
            text-align: left; /* 从center改为left */
            line-height: 1.5;
        }
        
        .info-banner {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(15px);
            padding: 15px 20px;
            border-radius: 16px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 2px solid rgba(108,117,125,0.2);
            font-size: 0.95em;
            color: #495057;
            line-height: 1.5;
            text-align: left; /* 已经是left，保持不变 */
        }
        
        h2 {
            color: #495057;
            margin: 0 0 25px 0;
            border-bottom: 2px solid rgba(108,117,125,0.2);
            padding-bottom: 15px;
            font-size: 1.3em;
            text-align: left; /* 从center改为left */
            font-weight: 700;
            letter-spacing: -0.3px;
        }
        
        .options {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .option {
            cursor: pointer;
            padding: 10px 12px;
            border: 2px solid #dee2e6;
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1.2em;
            font-weight: 600;
            min-width: 42px;
            height: 42px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            background: linear-gradient(145deg, #fff, #f8f9fa);
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            color: #495057;
        }
        
        .option:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            border-color: #6c757d;
        }
        
        .option:active {
            transform: translateY(0) scale(0.98);
        }
        
        .option.selected {
            background: linear-gradient(135deg, #6c757d, #495057) !important;
            color: #fff !important;
            border-color: #495057 !important;
            box-shadow: 0 6px 20px rgba(108,117,125,0.4) !important;
            transform: translateY(-2px) scale(1.1);
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
        
        .custom-item input {
            border: 2px solid rgba(108,117,125,0.3);
            border-radius: 12px;
            padding: 14px 16px;
            width: 100%;
            font-size: 16px;
            background: rgba(255,255,255,0.9);
            transition: all 0.3s ease;
            font-weight: 500;
            color: #495057;
        }
        
        .custom-item input:focus {
            outline: none;
            border-color: #6c757d;
            background: rgba(255,255,255,1);
            box-shadow: 0 0 0 3px rgba(108,117,125,0.1);
            transform: translateY(-1px);
        }
        
        .export-buttons {
            position: sticky;
            bottom: 0;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            padding: 20px 15px;
            margin: 30px -15px -15px -15px;
            border-top: 2px solid rgba(108,117,125,0.2);
            box-shadow: 0 -8px 32px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: row; /* 改为横向排列 */
            justify-content: center; /* 居中对齐 */
            gap: 10px; /* 减小间距 */
        }
        
        .export-buttons button {
            background: linear-gradient(135deg, #6c757d, #495057);
            color: white;
            border: none;
            padding: 12px 16px; /* 减小内边距 */
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.9em; /* 减小字体大小 */
            font-weight: 600;
            min-height: 44px; /* 减小最小高度 */
            -webkit-tap-highlight-color: transparent;
            box-shadow: 0 4px 15px rgba(108,117,125,0.3);
            letter-spacing: 0.5px;
            flex: 1; /* 让按钮平均分配空间 */
            max-width: 45%; /* 限制最大宽度 */
        }
        
        /* Desktop styles */
        @media (min-width: 768px) {
            body {
                max-width: 800px;
                margin: 0 auto;
                padding: 30px;
            }
            
            h1 {
                font-size: 1.8em;
                margin-bottom: 15px;
            }
            
            .partner-names {
                flex-direction: row;
                justify-content: center;
                align-items: center;
                gap: 15px;
            }
            
            .legend {
                display: flex;
                flex-wrap: wrap;
                gap: 20px;
            }
            
            .legend span {
                margin-right: 0;
            }
            
            .item {
                flex-direction: row;
                align-items: center;
                gap: 15px;
                padding: 12px 15px;
            }
            
            .item-text {
                flex: 1;
            }
            
            .options {
                justify-content: flex-end;
            }
            
            .export-buttons {
                position: static;
                flex-direction: row;
                justify-content: center;
                margin: 30px 0 0 0;
                padding: 20px;
                border-top: none;
                box-shadow: none;
                background-color: transparent;
                gap: 15px; /* 恢复间距 */
            }
            
            .export-buttons button {
                min-height: auto;
                padding: 12px 24px;
                font-size: 1em; /* 恢复字体大小 */
                flex: none; /* 取消弹性布局 */
                max-width: none; /* 取消最大宽度限制 */
            }
        }
        
        @media print {
            .option.selected {
                border: 2px solid #000 !important;
                font-weight: bold;
                background-color: #000 !important;
                color: #fff !important;
            }
            
            .export-buttons, .language-toggle, .info-banner {
                display: none;
            }
        }
    </style>
</head>
<body>
    <button class="language-toggle" onclick="toggleLanguage()">中文</button>
    
    <h1 id="title">NON-ESCALATOR RELATIONSHIP MENU</h1>
    <div class="partner-names">
        <input type="text" id="partner1" placeholder="Partner 1 Name">
        <span>&</span>
        <input type="text" id="partner2" placeholder="Partner 2 Name">
    </div>
    
    <div class="info-banner">
        <p id="info-text"><strong>Note:</strong> This menu is a starting point for conversation, not a fixed list of commitments. All items can be customized to your relationship. Double-click any item to edit it.</p>
        <p id="deescalation-text"><strong>Relationship Fluidity:</strong> Relationships can naturally evolve over time, including becoming less intense or transitioning to friendship. This is a normal part of relating and doesn't represent failure.</p>
    </div>
    
    <div class="legend">
        <span id="legend-must">■ Must Have</span>
        <span id="legend-like">♥ Like to Have</span>
        <span id="legend-maybe">? Maybe</span>
        <span id="legend-off">✘ Off Limits</span>
    </div>

    <div class="section" id="connection">
        <h2 id="connection-title">CONNECTION & AGREEMENTS</h2>
        <!-- Items will be dynamically generated by JavaScript -->
    </div>

    <div class="section" id="emotional">
        <h2 id="emotional-title">EMOTIONAL INTIMACY</h2>
    </div>

    <div class="section" id="social">
        <h2 id="social-title">SOCIAL INTEGRATION</h2>
    </div>

    <div class="section" id="physical">
        <h2 id="physical-title">PHYSICAL INTIMACY & SEXUAL HEALTH</h2>
    </div>

    <div class="section" id="communication">
        <h2 id="communication-title">COMMUNICATION</h2>
    </div>

    <div class="section" id="quality">
        <h2 id="quality-title">QUALITY TIME</h2>
    </div>

    <div class="section" id="financial">
        <h2 id="financial-title">FINANCIAL MATTERS</h2>
    </div>

    <div class="section" id="autonomy">
        <h2 id="autonomy-title">AUTONOMY</h2>
    </div>

    <div class="section" id="miscellaneous">
        <h2 id="miscellaneous-title">MISCELLANEOUS</h2>
    </div>

    <div class="export-buttons">
        <button onclick="window.print()" id="export-pdf">Export to PDF</button>
        <button onclick="exportToExcel()" id="export-excel">Export to Excel</button>
    </div>

    <script>
        let currentLanguage = 'en';
        
        const translations = {
            en: {
                title: 'NON-ESCALATOR RELATIONSHIP MENU',
                partner1: 'Partner 1 Name',
                partner2: 'Partner 2 Name',
                legendMust: '■ Must Have',
                legendLike: '♥ Like to Have',
                legendMaybe: '? Maybe',
                legendOff: '✘ Off Limits',
                connectionTitle: 'CONNECTION & AGREEMENTS',
                emotionalTitle: 'EMOTIONAL INTIMACY',
                socialTitle: 'SOCIAL INTEGRATION',
                physicalTitle: 'PHYSICAL INTIMACY & SEXUAL HEALTH',
                communicationTitle: 'COMMUNICATION',
                qualityTitle: 'QUALITY TIME',
                financialTitle: 'FINANCIAL MATTERS',
                autonomyTitle: 'AUTONOMY',
                miscellaneousTitle: 'MISCELLANEOUS',
                exportPdf: 'Export to PDF',
                exportExcel: 'Export to Excel',
                customPlaceholder: 'Add your own item...',
                infoText: '<strong>Note:</strong> This menu is a starting point for conversation, not a fixed list of commitments. All items can be customized to your relationship. Double-click any item to edit it.',
                deescalationText: '<strong>Relationship Fluidity:</strong> Relationships can naturally evolve over time, including becoming less intense or transitioning to friendship. This is a normal part of relating and doesn\'t represent failure.'
            },
            zh: {
                title: '去阶梯化关系协定菜单',
                partner1: '伴侣1姓名',
                partner2: '伴侣2姓名',
                legendMust: '■ 必须有',
                legendLike: '♥ 希望有',
                legendMaybe: '? 也许',
                legendOff: '✘ 禁止',
                connectionTitle: '连接与协定',
                emotionalTitle: '情感亲密度',
                socialTitle: '社交融合',
                physicalTitle: '身体亲密与性健康',
                communicationTitle: '沟通方式',
                qualityTitle: '优质时光',
                financialTitle: '财务事项',
                autonomyTitle: '个人自主',
                miscellaneousTitle: '其他事项',
                exportPdf: '导出为PDF',
                exportExcel: '导出为Excel',
                customPlaceholder: '添加您自己的项目...',
                infoText: '<strong>注意：</strong>此菜单是对话的起点，而非固定的承诺清单。所有条目都可以根据你们的关系进行自定义。双击任何条目可以编辑。',
                deescalationText: '<strong>关系流动：</strong>关系可以随时间自然演变，包括变得不那么紧密或转变为友谊。这是关系的正常部分，并不代表失败。'
            }
        };

        const menuData = {
    en: {
        connection: [
            'Transparency about other partners/apps (with regular updates)',
            'Keeping planned meetups consistent (find your ideal frequency)',
            'Honesty about feelings & boundaries (ongoing open dialogue)',
            'Safer-sex agreements (testing schedule and protection use)',
            'Regular relationship check-ins (set your schedule)',
            'Owning emotional impact (without blame)',
            'Exclusivity expectations (none/partial/specific activities)',
            'Comfort with relationship changes (including de-escalation)',
            'Respecting emotional connection pace',
            ''
        ],
        emotional: [
            'Sharing joys & frustrations (regular sharing)',
            'Support during tough times (within capacity)',
            'Willingness to be vulnerable (at your own pace)',
            'Sharing personal growth goals (check-ins)',
            'Sharing feelings after dating others (timing preference)',
            'Respecting emotional space (ask before deep talks)',
            'Discussing mental health needs (proactive)',
            'Using pet names (set preferences)',
            'Celebrating each other\'s wins (active support)',
            'Judgment-free space for jealousy',
            ''
        ],
        social: [
            'Time with mutual friends (frequency)',
            'Meeting metamours when ready (no pressure)',
            'Group events/parties together (e.g. monthly)',
            'Social media boundaries (tagging/posting)',
            'Festivals/concerts as a team (seasonal)',
            'Privacy with family/work circles',
            'Group vacations (annual/semi-annual)',
            'How we introduce each other (preferred terms)',
            'Comfort with PDA in different settings',
            ''
        ],
        autonomy: [
            'Keeping independent friendships (solo social time)',
            'Supporting personal goals/careers (encouragement)',
            'Balance of together & alone time (e.g. 2:1 ratio)',
            'Freedom to travel/move solo (with communication)',
            'Equal say in relationship decisions (consensus)',
            'Personal space needs (hours/days per week)',
            'Independent decision boundaries (what needs discussion)',
            'Comfort with spontaneous plans',
            ''
        ],
        miscellaneous: [
            'Pet/plant care for each other (as needed)',
            'Creative collabs (music, art, projects)',
            'Sharing playlists/books (frequency)',
            'Wellness support (joint workouts, meditation)',
            'Skill sharing (monthly exchanges)',
            'Spiritual/mindfulness practices (respect differences)',
            'Lifestyle compatibility (cleaning, sleep habits)',
            ''
        ],
        physical: [
            'Kissing/cuddling comfort & frequency',
            'Manual/oral sex preferences',
            'Penetrative sex frequency & boundaries',
            'Exploring kinks/fantasies (with communication)',
            'Mutual masturbation/toy play comfort',
            'STI testing schedule (e.g. every 3-6 months)',
            'Protection agreements (who, what activities)',
            'Sleepover frequency',
            'Consent check-ins during intimacy (verbal/non-verbal)',
            'Aftercare needs (touch, space, talking)',
            'Public affection boundaries',
            ''
        ],
        communication: [
            'Text check-ins (frequency)',
            'Video/voice calls when apart',
            'Sharing daily experiences (depth)',
            'Sharing after dates with others (detail/timing)',
            'Conflict resolution (cool-down, format)',
            'Shared calendars (tools, updates)',
            'Honesty style (direct/gentle/written)',
            'Response time expectations (urgent/casual)',
            'Minimum communication during busy times',
            'Expressing needs vs demands',
            ''
        ],
        quality: [
            'Regular date nights (e.g. weekly)',
            'Spontaneous hangouts (last-minute ok?)',
            'Shared hobbies (climbing, games, music)',
            'Weekend trips (monthly/quarterly)',
            'Home activities (cooking, movies)',
            'Learning together (workshops, classes)',
            'Celebrating special occasions',
            'Trying new experiences together (monthly)',
            ''
        ],
        financial: [
            'Cost sharing (50/50, income-based)',
            'Date payments (taking turns, treating)',
            'Gift expectations (budget, occasions)',
            'Financial boundaries (no shared accounts/loans)',
            'Transparency on shared expenses',
            'Trip cost splitting (planning)',
            'Support during money struggles (boundaries)',
            ''
        ]
    },
    zh: {
        connection: [
            '其他伴侣/交友动态透明（定期更新）',
            '按计划见面（找到理想频率）',
            '坦诚表达感受和边界（保持开放对话）',
            '安全性行为约定（检测计划及防护措施）',
            '定期关系检视（设定时间表）',
            '承担情感影响（不指责）',
            '排他性期待（无/部分/特定活动）',
            '接受关系变化（包括疏远可能）',
            '尊重情感连接节奏',
            ''
        ],
        emotional: [
            '分享快乐与烦恼（定期交流）',
            '困难时期相互支持（力所能及）',
            '愿意展现脆弱面（按自己节奏）',
            '分享个人成长目标（定期沟通）',
            '与他人约会后情绪沟通（时机偏好）',
            '尊重情感空间（深入交流前询问）',
            '讨论心理健康需求（主动）',
            '使用亲密称呼（设定偏好）',
            '庆祝彼此成功（主动认可）',
            '无评判处理嫉妒情绪',
            ''
        ],
        social: [
            '与共同朋友相处（频率偏好）',
            '舒适时见其他伴侣（无压力）',
            '共同参加聚会/派对（如每月）',
            '社交媒体边界（标记/发帖）',
            '组队参加音乐节/演唱会（季节性）',
            '家人/工作圈的隐私',
            '朋友团体旅行（每年/半年）',
            '介绍彼此的方式（偏好称呼）',
            '不同场合公开亲密行为的接受度',
            ''
        ],
        autonomy: [
            '保持独立朋友圈（独处社交时间）',
            '支持个人目标/事业（鼓励）',
            '独处与共处平衡（如2:1比例）',
            '自由旅行或搬迁（需沟通）',
            '关系决策平等权（共识制）',
            '个人空间需求（每周小时/天）',
            '独立决策范围（需商议事项）',
            '接受临时约会计划',
            ''
        ],
        miscellaneous: [
            '互相照顾宠物/植物（按需）',
            '创意合作（音乐、艺术、项目）',
            '分享歌单/书单（频率）',
            '健康互助（共同锻炼、冥想）',
            '技能分享（每月交流）',
            '精神/正念实践（尊重差异）',
            '生活习惯兼容性（清洁、作息）',
            ''
        ],
        physical: [
            '接吻/拥抱舒适度及频率',
            '手动/口交偏好',
            '插入式性行为频率及边界',
            '探索特殊癖好/幻想（需沟通）',
            '互助自慰/玩具使用舒适度',
            '性传播感染检测计划',
            '防护措施约定（对象及活动）',
            '过夜频率',
            '亲密行为中确认同意（语言/动作）',
            '事后关怀需求（触摸/空间/交谈）',
            '公开场合亲密边界',
            ''
        ],
        communication: [
            '文字交流（频率）',
            '分开时的视频/语音通话',
            '分享日常经历（深度）',
            '与他人约会后交流（细节/时机）',
            '解决冲突（冷静期/方式）',
            '共享日程（工具/更新）',
            '诚实表达方式（直接/温和/书面）',
            '回复时间期望（紧急/日常）',
            '忙碌时最低沟通保证',
            '区分需求与要求的表达',
            ''
        ],
        quality: [
            '固定约会夜（如每周）',
            '临时相聚（接受突发计划）',
            '共同爱好（攀岩、游戏、音乐）',
            '周末旅行（每月/每季）',
            '家庭活动（做饭、电影）',
            '共同学习（工作坊、课程）',
            '庆祝特殊日子',
            '尝试新体验（如每月）',
            ''
        ],
        financial: [
            '费用分担（AA制/按收入比例）',
            '约会付款（轮流/特殊场合请客）',
            '送礼期待（预算/场合）',
            '财务边界（无共享账户/借贷）',
            '共享支出透明',
            '旅行费用分摊（规划）',
            '财务困难时支持（边界）',
            ''
        ]
    }
};
         

        const options = ['■', '♥', '?', '✘'];

        function toggleLanguage() {
            currentLanguage = currentLanguage === 'en' ? 'zh' : 'en';
            updateLanguage();
            
            // Clear and reinitialize all sections
            Object.keys(menuData[currentLanguage]).forEach(sectionId => {
                const section = document.getElementById(sectionId);
                // Remove all items except the title
                const items = section.querySelectorAll('.item');
                items.forEach(item => item.remove());
                
                // Reinitialize with new language
                initializeSection(sectionId, menuData[currentLanguage][sectionId]);
            });
        }

        function updateLanguage() {
            const lang = translations[currentLanguage];
            
            document.getElementById('title').textContent = lang.title;
            document.getElementById('partner1').placeholder = lang.partner1;
            document.getElementById('partner2').placeholder = lang.partner2;
            document.getElementById('legend-must').textContent = lang.legendMust;
            document.getElementById('legend-like').textContent = lang.legendLike;
            document.getElementById('legend-maybe').textContent = lang.legendMaybe;
            document.getElementById('legend-off').textContent = lang.legendOff;
            document.getElementById('connection-title').textContent = lang.connectionTitle;
            document.getElementById('emotional-title').textContent = lang.emotionalTitle;
            document.getElementById('social-title').textContent = lang.socialTitle;
            document.getElementById('physical-title').textContent = lang.physicalTitle;
            document.getElementById('communication-title').textContent = lang.communicationTitle;
            document.getElementById('quality-title').textContent = lang.qualityTitle;
            document.getElementById('financial-title').textContent = lang.financialTitle;
            document.getElementById('autonomy-title').textContent = lang.autonomyTitle;
            document.getElementById('miscellaneous-title').textContent = lang.miscellaneousTitle;
            document.getElementById('export-pdf').textContent = lang.exportPdf;
            document.getElementById('export-excel').textContent = lang.exportExcel;
            document.getElementById('info-text').innerHTML = lang.infoText;
            document.getElementById('deescalation-text').innerHTML = lang.deescalationText;
            
            // Update button text
            document.querySelector('.language-toggle').textContent = currentLanguage === 'en' ? '中文' : 'English';
            
            // Update custom item placeholders
            document.querySelectorAll('.custom-item input').forEach(input => {
                input.placeholder = lang.customPlaceholder;
            });
        }

        function createItem(text, isCustom = false) {
            const item = document.createElement('div');
            item.className = 'item';

            if (isCustom) {
                const input = document.createElement('input');
                input.type = 'text';
                input.placeholder = translations[currentLanguage].customPlaceholder;
                input.className = 'custom-item';
                item.appendChild(input);
                item.className = 'item custom-item';
                
                // 添加回车键处理
                input.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter') {
                        const newText = this.value.trim();
                        if (newText) {
                            // 创建一个新的普通条目
                            const newItem = createItem(newText);
                            // 将新条目插入到当前自定义条目之前
                            item.parentNode.insertBefore(newItem, item);
                            // 清空输入框
                            this.value = '';
                        }
                    }
                });
            } else {
                const textDiv = document.createElement('div');
                textDiv.className = 'item-text editable';
                textDiv.textContent = text;
                textDiv.style.textAlign = 'left'; // 设置文本左对齐
                
                // Add double-click to edit functionality
                textDiv.addEventListener('dblclick', function() {
                    const currentText = this.textContent;
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.value = currentText;
                    input.className = 'editing-input';
                    
                    // 设置输入框宽度与原文本相同
                    const textWidth = this.offsetWidth;
                    input.style.minWidth = textWidth + 'px';
                    
                    this.textContent = '';
                    this.appendChild(input);
                    input.focus();
                    
                    // 自动调整输入框大小
                    input.style.height = 'auto';
                    input.style.height = (input.scrollHeight) + 'px';
                    
                    function finishEditing() {
                        const newText = input.value.trim();
                        if (newText) {
                            textDiv.textContent = newText;
                        } else {
                            textDiv.textContent = currentText;
                        }
                    }
                    
                    input.addEventListener('blur', finishEditing);
                    input.addEventListener('keydown', function(e) {
                        if (e.key === 'Enter') {
                            finishEditing();
                        }
                    });
                    
                    // 添加输入事件监听器以自动调整大小
                    input.addEventListener('input', function() {
                        this.style.height = 'auto';
                        this.style.height = (this.scrollHeight) + 'px';
                    });
                });
                
                item.appendChild(textDiv);
            }

            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options';

            options.forEach(option => {
                const optionSpan = document.createElement('span');
                optionSpan.className = 'option';
                optionSpan.textContent = option;
                optionSpan.onclick = function() {
                    optionsDiv.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
                    optionSpan.classList.add('selected');
                };
                optionsDiv.appendChild(optionSpan);
            });

            item.appendChild(optionsDiv);
            return item;
        }

        function initializeSection(sectionId, items) {
            const section = document.getElementById(sectionId);
            items.forEach(item => {
                section.appendChild(createItem(item, item === ''));
            });
            
            // 移除以下加号按钮代码
            // const addButtonDiv = document.createElement('div');
            // addButtonDiv.className = 'add-item-button';
            // addButtonDiv.appendChild(addButton);
            // section.appendChild(addButtonDiv);
        }

        // Initialize all sections with English content
        Object.keys(menuData[currentLanguage]).forEach(sectionId => {
            initializeSection(sectionId, menuData[currentLanguage][sectionId]);
        });
    
        function exportToExcel() {
            const wb = XLSX.utils.book_new();
            const data = [];
    
            // Add headers
            data.push(['Section', 'Item', 'Selection']);
    
            // Add data from each section
            Object.keys(menuData[currentLanguage]).forEach(sectionId => {
                const section = document.getElementById(sectionId);
                const title = section.querySelector('h2').textContent;
                
                const items = section.querySelectorAll('.item');
                items.forEach(item => {
                    const selected = item.querySelector('.selected');
                    const text = item.querySelector('input')?.value || item.querySelector('.item-text')?.textContent?.trim();
                    const mark = selected ? selected.textContent : '';
                    
                    if (text) {
                        data.push([title, text, mark]);
                    }
                });
            });
    
            const ws = XLSX.utils.aoa_to_sheet(data);
            XLSX.utils.book_append_sheet(wb, ws, 'Relationship Menu');
            XLSX.writeFile(wb, 'relationship-menu.xlsx');
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</body>
</html>
