<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NON-ESCALATOR ENM RELATIONSHIP MENU</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            margin: 0 auto;
            padding: 15px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 50%, #dee2e6 100%);
            min-height: 100vh;
            line-height: 1.4;
            max-width: 100%;
            text-align: center;
        }
        
        h1 {
            color: #495057;
            text-align: center;
            margin: 0 0 20px 0;
            font-size: 1.6em;
            padding: 0 10px;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(255,255,255,0.8);
            letter-spacing: -0.5px;
        }
        
        .language-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255,255,255,0.9);
            backdrop-filter: blur(10px);
            border: 2px solid #6c757d;
            border-radius: 20px;
            padding: 8px 16px;
            font-size: 0.9em;
            font-weight: 600;
            color: #495057;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .language-toggle:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            border-color: #495057;
        }
        
        .partner-names {
            text-align: center;
            margin-bottom: 30px;
            font-size: 1em;
            color: #495057;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
            font-weight: 500;
        }
        
        .partner-names span {
            font-size: 1.2em;
            font-weight: 600;
        }
        
        .partner-names input[type="text"] {
            width: 100%;
            max-width: 200px;
            padding: 14px 18px;
            border: 2px solid #dee2e6;
            border-radius: 25px;
            font-size: 16px;
            text-align: center;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            font-weight: 500;
            color: #495057;
        }
        
        .partner-names input[type="text"]:focus {
            outline: none;
            background: rgba(255,255,255,1);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            border-color: #6c757d;
        }
        
        .legend {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(15px);
            padding: 20px;
            border-radius: 16px;
            margin-bottom: 25px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 2px solid rgba(108,117,125,0.2);
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            font-size: 1em;
            text-align: center;
        }
        
        .legend span {
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.1em;
            color: #495057;
        }
        
        .section {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(15px);
            padding: 25px 20px;
            margin-bottom: 20px;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 2px solid rgba(108,117,125,0.2);
        }
        
        h2 {
            color: #495057;
            margin: 0 0 25px 0;
            border-bottom: 2px solid rgba(108,117,125,0.2);
            padding-bottom: 15px;
            font-size: 1.3em;
            text-align: center;
            font-weight: 700;
            letter-spacing: -0.3px;
        }
        
        .item {
            margin: 18px 0;
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding: 20px 18px;
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 12px;
            border: 2px solid rgba(108,117,125,0.15);
            transition: all 0.3s ease;
        }
        
        .item:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.1);
            border-color: rgba(108,117,125,0.3);
        }
        
        .item-text {
            font-size: 1.1em;
            color: #495057;
            font-weight: 500;
            text-align: center;
            line-height: 1.5;
        }
        
        .options {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .option {
            cursor: pointer;
            padding: 10px 12px;
            border: 2px solid #dee2e6;
            border-radius: 12px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1.2em;
            font-weight: 600;
            min-width: 42px;
            height: 42px;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            background: linear-gradient(145deg, #fff, #f8f9fa);
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            color: #495057;
        }
        
        .option:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            border-color: #6c757d;
        }
        
        .option:active {
            transform: translateY(0) scale(0.98);
        }
        
        .option.selected {
            background: linear-gradient(135deg, #6c757d, #495057) !important;
            color: #fff !important;
            border-color: #495057 !important;
            box-shadow: 0 6px 20px rgba(108,117,125,0.4) !important;
            transform: translateY(-2px) scale(1.1);
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }
        
        .custom-item input {
            border: 2px solid rgba(108,117,125,0.3);
            border-radius: 12px;
            padding: 14px 16px;
            width: 100%;
            font-size: 16px;
            background: rgba(255,255,255,0.9);
            transition: all 0.3s ease;
            font-weight: 500;
            color: #495057;
        }
        
        .custom-item input:focus {
            outline: none;
            border-color: #6c757d;
            background: rgba(255,255,255,1);
            box-shadow: 0 0 0 3px rgba(108,117,125,0.1);
            transform: translateY(-1px);
        }
        
        .export-buttons {
            position: sticky;
            bottom: 0;
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(20px);
            padding: 20px 15px;
            margin: 30px -15px -15px -15px;
            border-top: 2px solid rgba(108,117,125,0.2);
            box-shadow: 0 -8px 32px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .export-buttons button {
            background: linear-gradient(135deg, #6c757d, #495057);
            color: white;
            border: none;
            padding: 16px 24px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 1em;
            font-weight: 600;
            min-height: 52px;
            -webkit-tap-highlight-color: transparent;
            box-shadow: 0 4px 15px rgba(108,117,125,0.3);
            letter-spacing: 0.5px;
        }
        
        .export-buttons button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(108,117,125,0.4);
        }
        
        .export-buttons button:active {
            transform: translateY(-1px);
        }
        
        /* Desktop styles */
        @media (min-width: 768px) {
            body {
                max-width: 800px;
                margin: 0 auto;
                padding: 30px;
            }
            
            h1 {
                font-size: 1.8em;
                margin-bottom: 15px;
            }
            
            .partner-names {
                flex-direction: row;
                justify-content: center;
                align-items: center;
                gap: 15px;
            }
            
            .legend {
                display: flex;
                flex-wrap: wrap;
                gap: 20px;
            }
            
            .legend span {
                margin-right: 0;
            }
            
            .item {
                flex-direction: row;
                align-items: center;
                gap: 15px;
                padding: 12px 15px;
            }
            
            .item-text {
                flex: 1;
            }
            
            .options {
                justify-content: flex-end;
            }
            
            .export-buttons {
                position: static;
                flex-direction: row;
                justify-content: center;
                margin: 30px 0 0 0;
                padding: 20px;
                border-top: none;
                box-shadow: none;
                background-color: transparent;
            }
            
            .export-buttons button {
                min-height: auto;
                padding: 12px 24px;
            }
        }
        
        @media print {
            .option.selected {
                border: 2px solid #000 !important;
                font-weight: bold;
                background-color: #000 !important;
                color: #fff !important;
            }
            
            .export-buttons, .language-toggle {
                display: none;
            }
        }
    </style>
</head>
<body>
    <button class="language-toggle" onclick="toggleLanguage()">中文</button>
    
    <h1 id="title">NON-ESCALATOR ENM RELATIONSHIP MENU</h1>
    <div class="partner-names">
        <input type="text" id="partner1" placeholder="Partner 1 Name">
        <span>&</span>
        <input type="text" id="partner2" placeholder="Partner 2 Name">
    </div>
    
    <div class="legend">
        <span id="legend-must">■ Must Have</span>
        <span id="legend-like">♥ Like to Have</span>
        <span id="legend-maybe">? Maybe</span>
        <span id="legend-off">✘ Off Limits</span>
    </div>

    <div class="section" id="connection">
        <h2 id="connection-title">CONNECTION & AGREEMENTS</h2>
        <!-- Items will be dynamically generated by JavaScript -->
    </div>

    <div class="section" id="emotional">
        <h2 id="emotional-title">EMOTIONAL INTIMACY</h2>
    </div>

    <div class="section" id="social">
        <h2 id="social-title">SOCIAL INTEGRATION</h2>
    </div>

    <div class="section" id="physical">
        <h2 id="physical-title">PHYSICAL INTIMACY & SEXUAL HEALTH</h2>
    </div>

    <div class="section" id="communication">
        <h2 id="communication-title">COMMUNICATION</h2>
    </div>

    <div class="section" id="quality">
        <h2 id="quality-title">QUALITY TIME</h2>
    </div>

    <div class="section" id="financial">
        <h2 id="financial-title">FINANCIAL MATTERS</h2>
    </div>

    <div class="section" id="autonomy">
        <h2 id="autonomy-title">AUTONOMY</h2>
    </div>

    <div class="section" id="miscellaneous">
        <h2 id="miscellaneous-title">MISCELLANEOUS</h2>
    </div>

    <div class="export-buttons">
        <button onclick="window.print()" id="export-pdf">Export to PDF</button>
        <button onclick="exportToExcel()" id="export-excel">Export to Excel</button>
    </div>

    <script>
        let currentLanguage = 'en';
        
        const translations = {
            en: {
                title: 'NON-ESCALATOR ENM RELATIONSHIP MENU',
                partner1: 'Partner 1 Name',
                partner2: 'Partner 2 Name',
                legendMust: '■ Must Have',
                legendLike: '♥ Like to Have',
                legendMaybe: '? Maybe',
                legendOff: '✘ Off Limits',
                connectionTitle: 'CONNECTION & AGREEMENTS',
                emotionalTitle: 'EMOTIONAL INTIMACY',
                socialTitle: 'SOCIAL INTEGRATION',
                physicalTitle: 'PHYSICAL INTIMACY & SEXUAL HEALTH',
                communicationTitle: 'COMMUNICATION',
                qualityTitle: 'QUALITY TIME',
                financialTitle: 'FINANCIAL MATTERS',
                autonomyTitle: 'AUTONOMY',
                miscellaneousTitle: 'MISCELLANEOUS',
                exportPdf: 'Export to PDF',
                exportExcel: 'Export to Excel',
                customPlaceholder: 'Add your own item...'
            },
            zh: {
                title: '自定义开放式关系协议',
                partner1: '伴侣1姓名',
                partner2: '伴侣2姓名',
                legendMust: '■ 必须有',
                legendLike: '♥ 希望有',
                legendMaybe: '? 也许',
                legendOff: '✘ 禁止',
                connectionTitle: '信任连接',
                emotionalTitle: '情感支持',
                socialTitle: '社交互动',
                physicalTitle: '亲密行为',
                communicationTitle: '沟通方式',
                qualityTitle: '优质时光',
                financialTitle: '财务协议',
                autonomyTitle: '个人自主',
                miscellaneousTitle: '其他事项',
                exportPdf: '导出为PDF',
                exportExcel: '导出为Excel',
                customPlaceholder: '添加您自己的项目...'
            }
        };

        const menuData = {
            en: {
                connection: [
                    'Transparency about other partners / dating apps',
                    'Consistency in planned meet-ups',
                    'Honesty about feelings & boundaries',
                    'Commitment to safer-sex practices (barriers, testing cadence)',
                    'Regular renegotiation of agreements',
                    'Emotional responsibility (owning impact, not blame)',
                    'Clarity on exclusivity expectations (e.g., none / partial)',
                    '',
                    ''
                ],
                emotional: [
                    'Sharing joys & frustrations',
                    'Offering support during rough days',
                    'Willingness to be vulnerable',
                    'Sharing personal growth goals',
                    'Check-ins about feelings after seeing others',
                    'Respecting emotional boundaries & space',
                    'Discussing mental-health needs',
                    'Using chosen endearments / pet names',
                    '',
                    ''
                ],
                social: [
                    'Hanging out with mutual friends',
                    'Meeting metamours (partners\' partners) if comfortable',
                    'Casual group events / parties together',
                    'Tagging or mentioning each other on social media',
                    'Attending festivals / concerts as a group',
                    'Remaining private from family or professional circles',
                    'Vacationing with friend groups',
                    '',
                    ''
                ],
                autonomy: [
                    'Maintaining independent friendships',
                    'Supporting each other\'s personal goals / careers',
                    'Balance of together & alone time',
                    'Freedom to travel or move independently',
                    'Equal say in relationship decisions',
                    '',
                    ''
                ],
                miscellaneous: [
                    'Pet-sitting or plant-sitting for each other',
                    'Creative collaborations (music, art, projects)',
                    'Sharing playlists / book recommendations',
                    'Wellness support (workouts, meditation)',
                    '',
                    '',
                    ''
                ],
                physical: [
                    'Kissing / cuddling',
                    'Manual / oral sex',
                    'Penetrative sex',
                    'Exploring kinks / fantasies',
                    'Mutual masturbation or toy play',
                    'Regular STI testing (e.g., every 3 months)',
                    'Condom / barrier use',
                    'Sleepovers',
                    'Consent & comfort check-ins during intimacy',
                    'Aftercare as needed',
                    '',
                    ''
                ],
                communication: [
                    'Daily or frequent text check-ins',
                    'Video / voice calls when apart',
                    'Sharing memes / hobbies',
                    'Debriefing after dates with others (optional)',
                    'Respectful conflict resolution',
                    'Scheduling via shared calendar',
                    'Radical honesty delivered with care',
                    'Expected response time guidelines',
                    '',
                    ''
                ],
                quality: [
                    'Regularly scheduled dates',
                    'Spontaneous hangouts',
                    'Shared hobbies (e.g., climbing, gaming, music)',
                    'Weekend trips / festivals',
                    'Cooking or movie nights at home',
                    'Attending workshops / classes together',
                    '',
                    ''
                ],
                financial: [
                    'Splitting costs equitably (50/50, sliding scale, etc.)',
                    'Alternating who pays for dates',
                    'Small gifts or experiences',
                    'No shared bank accounts',
                    'Discussing large expenses in advance',
                    '',
                    ''
                ]
            },
            zh: {
                connection: [
                     '对其他伴侣/交友软件保持透明',
            '按计划定期见面',
            '坦诚表达感受与边界',
            '安全性行为承诺（防护措施、检测频率）',
            '定期重新协商协议',
            '情感责任（承担影响，而非指责）',
            '明确排他性期待（如无/部分）',
                    '',
                    ''
                ],
                emotional: [
                     '分享快乐与烦恼',
            '困难时期提供支持',
            '愿意展现脆弱面',
            '分享个人成长目标',
            '与他人约会后的情绪沟通',
            '尊重情感边界与空间',
            '讨论心理健康需求',
            '使用专属亲密昵称',
                    '',
                    ''
                ],
                social: [
                     '与共同朋友聚会',
            '舒适前提下见元伴侣（伴侣的伴侣）',
            '共同参与休闲集体活动/派对',
            '在社交媒体上标记或提及对方',
            '组队参加音乐节/演唱会',
            '对家人或工作圈保持隐私',
            '与朋友团体旅行',
                    '',
                    ''
                ],
                autonomy: [
                    '保持独立友谊圈',
            '支持彼此个人目标/事业',
            '独处与共处时间平衡',
            '自由旅行或独立搬迁',
            '关系决策平等话语权',
                    '',
                    ''
                ],
                miscellaneous: [
                   '互相照顾宠物/植物',
            '创意合作（音乐、艺术、项目）',
            '分享歌单/书单',
            '健康互助（健身、冥想）',
                    '',
                    '',
                    ''
                ],
                physical: [
                     '接吻/拥抱',
            '手/口行为',
            '插入式性行为',
            '探索特殊癖好/幻想',
            '互助自慰或玩具使用',
            '定期性传播感染检测（如每3个月）',
            '使用安全套/屏障保护',
            '过夜留宿',
            '亲密行为前确认同意与舒适度',
            '按需事后关怀',
                    '',
                    ''
                ],
                communication: [
                   '每日/高频文字沟通',
            '异地时视频/语音通话',
            '分享表情包/兴趣爱好',
            '选择性分享他人约会细节',
            '建设性解决冲突',
            '共享日历协调日程',
            '谨慎表达的绝对坦诚',
            '约定回复时效标准',
                    '',
                    ''
                ],
                quality: [
                    '固定约会日',
            '临时见面',
            '共同爱好（攀岩、游戏、音乐等）',
            '周末短途/节日活动',
            '家庭电影晚餐夜',
            '一起参加课程/工作坊',
                    '',
                    ''
                ],
                financial: [
                     '公平分摊费用（AA制、浮动比例等）',
            '轮流支付约会开销',
            '小额礼物或体验消费',
            '不设共同银行账户',
            '大额支出提前协商',
                    '',
                    ''
                ]
            }
        };

        const options = ['■', '♥', '?', '✘'];

        function toggleLanguage() {
            currentLanguage = currentLanguage === 'en' ? 'zh' : 'en';
            updateLanguage();
            
            // Clear and reinitialize all sections
            Object.keys(menuData[currentLanguage]).forEach(sectionId => {
                const section = document.getElementById(sectionId);
                // Remove all items except the title
                const items = section.querySelectorAll('.item');
                items.forEach(item => item.remove());
                
                // Reinitialize with new language
                initializeSection(sectionId, menuData[currentLanguage][sectionId]);
            });
        }

        function updateLanguage() {
            const lang = translations[currentLanguage];
            
            document.getElementById('title').textContent = lang.title;
            document.getElementById('partner1').placeholder = lang.partner1;
            document.getElementById('partner2').placeholder = lang.partner2;
            document.getElementById('legend-must').textContent = lang.legendMust;
            document.getElementById('legend-like').textContent = lang.legendLike;
            document.getElementById('legend-maybe').textContent = lang.legendMaybe;
            document.getElementById('legend-off').textContent = lang.legendOff;
            document.getElementById('connection-title').textContent = lang.connectionTitle;
            document.getElementById('emotional-title').textContent = lang.emotionalTitle;
            document.getElementById('social-title').textContent = lang.socialTitle;
            document.getElementById('physical-title').textContent = lang.physicalTitle;
            document.getElementById('communication-title').textContent = lang.communicationTitle;
            document.getElementById('quality-title').textContent = lang.qualityTitle;
            document.getElementById('financial-title').textContent = lang.financialTitle;
            document.getElementById('autonomy-title').textContent = lang.autonomyTitle;
            document.getElementById('miscellaneous-title').textContent = lang.miscellaneousTitle;
            document.getElementById('export-pdf').textContent = lang.exportPdf;
            document.getElementById('export-excel').textContent = lang.exportExcel;
            
            // Update button text
            document.querySelector('.language-toggle').textContent = currentLanguage === 'en' ? '中文' : 'English';
            
            // Update custom item placeholders
            document.querySelectorAll('.custom-item input').forEach(input => {
                input.placeholder = lang.customPlaceholder;
            });
        }

        function createItem(text, isCustom = false) {
            const item = document.createElement('div');
            item.className = 'item';

            if (isCustom) {
                const input = document.createElement('input');
                input.type = 'text';
                input.placeholder = translations[currentLanguage].customPlaceholder;
                input.className = 'custom-item';
                item.appendChild(input);
                item.className = 'item custom-item';
            } else {
                const textDiv = document.createElement('div');
                textDiv.className = 'item-text';
                textDiv.textContent = text;
                item.appendChild(textDiv);
            }

            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'options';

            options.forEach(option => {
                const optionSpan = document.createElement('span');
                optionSpan.className = 'option';
                optionSpan.textContent = option;
                optionSpan.onclick = function() {
                    optionsDiv.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
                    optionSpan.classList.add('selected');
                };
                optionsDiv.appendChild(optionSpan);
            });

            item.appendChild(optionsDiv);
            return item;
        }

        function initializeSection(sectionId, items) {
            const section = document.getElementById(sectionId);
            items.forEach(item => {
                section.appendChild(createItem(item, item === ''));
            });
        }

        // Initialize all sections with English content
        Object.keys(menuData[currentLanguage]).forEach(sectionId => {
            initializeSection(sectionId, menuData[currentLanguage][sectionId]);
        });
    
        function exportToExcel() {
            const wb = XLSX.utils.book_new();
            const data = [];
    
            // Add headers
            data.push(['Section', 'Item', 'Selection']);
    
            // Add data from each section
            Object.keys(menuData[currentLanguage]).forEach(sectionId => {
                const section = document.getElementById(sectionId);
                const title = section.querySelector('h2').textContent;
                
                const items = section.querySelectorAll('.item');
                items.forEach(item => {
                    const selected = item.querySelector('.selected');
                    const text = item.querySelector('input')?.value || item.querySelector('.item-text')?.textContent?.trim();
                    const mark = selected ? selected.textContent : '';
                    
                    if (text) {
                        data.push([title, text, mark]);
                    }
                });
            });
    
            const ws = XLSX.utils.aoa_to_sheet(data);
            XLSX.utils.book_append_sheet(wb, ws, 'Relationship Menu');
            XLSX.writeFile(wb, 'relationship-menu.xlsx');
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</body>
</html>
